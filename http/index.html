<!doctype html>
<html>
  <head>
      <meta charset="utf-8">
      <title>Upload a spreadsheet</title>
      <meta name="author" content="ScraperWiki Ltd">

      <link rel="stylesheet" href="http://x.scraperwiki.com/vendor/style/bootstrap.min.css">
      <link rel="stylesheet" href="http://x.scraperwiki.com/style/scraperwiki.css">
      <link rel="stylesheet" href="style.css">

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
      <script src="http://x.scraperwiki.com/vendor/js/bootstrap.min.js"></script>
      <script src="http://coffeescript.org/extras/coffee-script.js"></script>
      <script src="http://x.scraperwiki.com/js/scraperwiki.js"></script>

      <meta http-equiv="cleartype" content="on">
  </head>
  <body>
    <form id="up" action="../../file/" method="POST" enctype="multipart/form-data">
      <input type="file" name="file" size="80" id="file">
      <input type="hidden" name="apikey" id="apikey">
      <input type="hidden" name="next" id="next">
      <input type="submit" value="Upload now!">
    </form>
    <script type="text/coffeescript">
      $ ->
        settings = scraperwiki.readSettings()
        $('#next').val "#{window.location.pathname}done.html#{window.location.hash}"
        $('#apikey').val settings.source.apikey
        $('input:submit').hide()
        $('#file').hide().on 'change', ->
          path = $(@)[0].files[0].name
          if path isnt ''
            $('#fake').addClass('loading disabled').html "Uploading #{path}&hellip;"
            $('input:submit').trigger 'click'
        $('<a id="fake">').html('Select a file&hellip;').on('click', ->
          $('#file').trigger 'click'
        ).addClass('btn btn-primary').appendTo '#up'
    </script>
  </body>
</html>

